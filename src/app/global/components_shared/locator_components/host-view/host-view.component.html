<div class="content-section">
	<div class="row" *ngIf="!loading_hosts; else loader">
		<div class="col-lg-6" >
			<ng-container *ngIf="hosts.length > 0; else no_host">
				<app-autocomplete-field
					[data_reference]="hosts_data"
					[primary_keyword]="'hostName'"
					[key_of_value]="'hostId'"
					(data_value)="onSelectHost($event)"
					[required]="true"
					[label]="'Type in a Host name here'"
					[paging]="paging"
					(call_next_page)="searchBoxTrigger($event)"
					[loading_data]="loading_data"
					(searched)="searchData($event)"
					[loading_search]="loading_search">
				</app-autocomplete-field>

				<mat-card class="p-4" *ngIf="selected_host as host; else no_record">

					<!-- HOST DETAILS -->
					<div class="align-items-center d-flex mb-3">
						<div class="flex-even">
							<h3>{{ host.name }}</h3>
							<p class="sm-text">{{ host.address }}, {{ host.state }} {{ host.postalCode }}</p>
						</div>
						<div class="text-right">
							<span class="sm-text">{{ host.category }}</span>
						</div>
					</div>

					<hr>

					<!-- DEALER DETAILS -->
					<div class="row">
						<div class="col-lg">
							<span class="sm-text w-100">Dealer</span>
							<p>
								<a [routerLink]="getLink('dealers', host_dealer.dealerId)" target="_blank">
									{{ host_dealer.businessName }}
								</a>
							</p>
						</div>
						<div class="col-lg">
							<span class="sm-text w-100">Dealer Alias</span>
							<p>
								<a [routerLink]="getLink('dealers', host_dealer.dealerId)" target="_blank">
									{{ host_dealer.dealerIdAlias }}
								</a>
							</p>
						</div>
					</div>

					<br>

					<!-- LATITUDE AND LONGITUDE -->
					<div class="row">
						<div class="col-lg">
							<span class="sm-text w-100">Latitude</span>
							<p>{{ host.latitude || '--' }}</p>
						</div>

						<div class="col-lg">
							<span class="sm-text w-100">Longitude</span>
							<p>{{ host.longitude || '--' }}</p>
						</div>
					</div>

					<hr>

					<!-- LICENSES -->
					<div class="row licenses">
						<div class="col-lg" *ngIf="licenses">
							<span class="sm-text w-100">Licenses</span>
							<ul *ngIf="licenses.length > 0">
								<li *ngFor="let license of licenses">
									<a [routerLink]="getLink('licenses', license.licenseId)" target="_blank">
										{{ (license.alias && license.alias.length > 0) ? license.alias : license.licenseKey }}
									</a>
								</li>
							</ul>
						</div>
					</div>

					<hr>

					<!-- STORE HOURS -->
					<div class="row">
						<div class="col-lg-12">
							<div *ngFor="let ops of storehours" class="bg-gray mb-3 p-3 border-bottom">
								<div class="mr-4">
									<p class="text-primary font-weight-md">{{ ops.day }}</p>
								</div>
								<div class="flex-even">
									<ul class="list-unstyled p-0 m-0">
										<li *ngFor="let hrs of ops.periods">
											<div class="d-flex">
												<div class="flex-even">
													<span class="sm-text">Open</span>
													<p>{{ hrs.open }}</p>
												</div>
												<div class="flex-even">
													<span class="sm-text">Close</span>
													<p>{{ hrs.close }}</p>
												</div>
											</div>
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>

				</mat-card>
			</ng-container>
		</div>

		<div class="col-6 col-lg" *ngIf="hosts.length > 0">
			<mat-card class="mb-4" *ngIf="licenses; else no_host_selected">
				<ng-container *ngIf="!loading_license_count; else loader_sm">
					<app-data-card-compare  
						*ngIf="license_card"
						[compare_basis]="license_card.basis" 
						[compare_basis_label]="license_card.basis_label"
						[good_value]="license_card.good_value" 
						[good_value_label]="license_card.good_value_label"
						[bad_value]="license_card.bad_value" 
						[bad_value_label]="license_card.bad_value_label">
					</app-data-card-compare>
				</ng-container>
			</mat-card>
			<div class="row mb-4">
				<div class="col-lg-3">
					<div class="d-flex align-items-center">
						<img src="assets/media-files/markers/online_all.png" alt="online-all">
						<p class="sm-text ml-2">All licenses are online</p>
					</div>
				</div>

				<div class="col-lg-3">
					<div class="d-flex align-items-center">
						<img src="assets/media-files/markers/online_many.png" alt="online-all">
						<p class="sm-text ml-2">More than 75% of licenses are online</p>
					</div>
				</div>
				
				<div class="col-lg-3">
					<div class="d-flex align-items-center">
						<img src="assets/media-files/markers/online_few.png" alt="online-all">
						<p class="sm-text ml-2">Less than 75% of licenses are online</p>
					</div>
				</div>

				<div class="col-lg-3">
					<div class="d-flex align-items-center">
						<img src="assets/media-files/markers/offline.png" alt="online-all">
						<p class="sm-text ml-2">All licenses are offline</p>
					</div>
				</div>
			</div>
			<agm-map class="vh-50" [latitude]="lat" [longitude]="lng" [fitBounds]="location_selected" [maxZoom]="19" >
				<agm-marker
					*ngIf="map_markers as h"
					[latitude]="h.latitude" 
					[longitude]="h.longitude"
					[agmFitBounds]="true"
					[iconUrl]="h.icon_url">
						<agm-info-window #window>
							<h4>{{ h.name }}</h4>
							<h6>Longitude: {{h.longitude}}</h6>
							<h6>Latitude: {{h.latitude}}</h6>
						</agm-info-window>
				</agm-marker>
			</agm-map>
			<p class="sm-text mt-3 bg-info p-3 text-white">Note: If host is displayed but no marker is shown please check the coordinates of that host.</p>
		</div>

	</div>

	<ng-template #loader>
        <div class="vh-50 d-flex align-items-center justify-content-center">
            <app-spinner></app-spinner>
        </div>
    </ng-template>

    <ng-template #loader_sm>
        <div class="text-center py-4">
			<app-spinner [diameter]="65"></app-spinner>
			<h5 class="mt-3">Getting License Information. Please Wait.</h5>
        </div>
    </ng-template>

    <ng-template #no_record>
        <mat-card class="vh-50 p-5">
            <div class="border-dashed d-flex align-items-center h-100 p-5 w-100">
                <div class="text-center w-100">
                    <span class="fas fa-map fa-2x text-primary mb-3"></span>
                    <h3>Welcome to Locator</h3>
                    <p class="sm-text">Enter a Host name above to start</p>
                </div>
            </div>
        </mat-card>
    </ng-template>

    <ng-template #no_host_selected>
        <mat-card class="p-3 mb-4">
            <div class="border-dashed d-flex align-items-center h-100 p-4 w-100">
                <div class="text-center w-100">
                    <h3>No Host Selected</h3>
                    <p class="sm-text">Search a Host to get license count</p>
                </div>
            </div>
        </mat-card>
    </ng-template>

	<ng-template #no_host>
        <div class="align-items-center justify-content-center">
            <h3>Oh Snap!</h3>
			<p class="sm-text mb-3">
				There are no available hosts places at the moment.
			</p>
			<button mat-button mat-raised-button class="theme-btn mr-2" (click)="createHostPlace()">
				Add Host Place
				<span class="fas fa-map-marker ml-2 sm-text"></span>
            </button>
        </div>
    </ng-template>
</div>