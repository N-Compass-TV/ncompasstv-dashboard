<div class="content-settings">
	<div class="row align-items-start mb-3">
		<div class="col-lg-6">
			<h3 class="m-0 font-weight-bold">Playlist Content Option</h3>
			<p class="sm-text m-0">Set duration, whitelisting, and display mode</p>
		</div>
		<div class="col-lg-2">
			<h3 class="m-0 font-weight-bold">{{ currentIndex + 1 }}</h3>
		</div>
		<div class="col-lg-4 text-right">
			<ng-container *ngIf="!contentData.bulkSet">
				<button class="modal-btn mr-2" (click)="prev()" [disabled]="prevDisabled">
					<span class="fas fa-arrow-left text-primary"></span>
				</button>

				<button class="modal-btn mr-2" (click)="next()" [disabled]="nextDisabled">
					<span class="fas fa-arrow-right text-primary"></span>
				</button>
			</ng-container>

			<button class="modal-btn" [mat-dialog-close]>
				<span class="fas fa-times text-danger"></span>
			</button>
		</div>
	</div>

	<div class="row mb-4 content-settings-min-height">
		<ng-container *ngIf="!updatingView; else loading">
			<!-- Info/Fullscreen/Duration/Frequency -->
			<div class="col-lg-6">
				<div class="playlist-content-preview mb-3" *ngIf="!contentData.bulkSet; else selected">
					<img
						*ngIf="contentData.playlistContents[0].fileType | isimage; else video"
						class="thumbnail-preview-100 border"
						[src]="contentData.playlistContents[0].thumbnail | sanitize"
						[alt]="contentData.playlistContents[0].fileName || contentData.playlistContents[0].title" />

					<ng-template #video>
						<video
							class="thumbnail-preview-100 border"
							[src]="contentData.playlistContents[0].url + contentData.playlistContents[0].fileName"
							controls
							muted></video>
					</ng-template>
				</div>

				<ng-template #selected>
					<div class="playlist-content-preview scroll bg-gray p-2 w-100 mb-3">
						<div class="row no-gutters mb-1">
							<div class="col-lg-3" *ngFor="let c of contentData.playlistContents; let i = index">
								<div class="m-1">
									<app-content [content]="c" [controls]="true" [enabled_controls]="['remove']" [index]="i + 1" [selectable]="false">
									</app-content>
								</div>
							</div>
						</div>
					</div>
				</ng-template>

				<!-- Playlist Content Basic Info -- Frequency/Fullscreen/Duration -->
				<div class="row mb-3" *ngIf="!contentData.bulkSet">
					<!-- Playlist Content Basic Info -->
					<div class="col-lg-8">
						<div class="playlist-content-basic-info">
							<h5 class="m-0 font-weight-bold">
								{{ contentData.playlistContents[0].fileName || contentData.playlistContents[0].title | nohandle | slice : 0 : 50 }}
							</h5>
							<p class="sm-text">Uploaded {{ contentData.playlistContents[0].dateCreated | date : 'MMM d, y, h:mm:ss a' }}</p>
						</div>
					</div>
					<div class="col-lg-4 text-right">
						<span
							class="text-primary fas mr-1"
							[ngClass]="{
								'fa-image': contentData.playlistContents[0].fileType | isimage,
								'fa-video': contentData.playlistContents[0].fileType | isvideo,
								'fa-rss': contentData.playlistContents[0].fileType | isFeed
							}">
						</span>
					</div>
				</div>

				<app-basic-settings
					[bulk_setting]="contentData.bulkSet"
					[has_image_and_feed]="hasImageAndFeed"
					[playlist_content]="contentData.playlistContents"
					(changed)="playlistContentModified($event)"></app-basic-settings>
			</div>
			<!-- Info/Fullscreen/Duration/Frequency -->

			<!-- Play Where/Content Schedule -->
			<div class="col-lg-6">
				<mat-tab-group mat-stretch-tabs>
					<mat-tab label="Content Schedule">
						<div class="mt-3 pb-2">
							<app-content-scheduler
								(schedule_type_emitter)="onSelectType($event)"
								[contents]="contentData.playlistContents"
								[hasExistingSchedule]="contentData.hasExistingSchedule"
								[scheduleType]="contentData.scheduleType">
							</app-content-scheduler>
						</div>
					</mat-tab>
					<mat-tab label="Play Where">
						<div class="play-where-wrapper" *ngIf="contentData.hostLicenses && contentData.hostLicenses.length; else loading">
							<div class="d-flex align-items-center pt-3">
								<div class="flex-even">
									<h4>Whitelist Host and Licenses</h4>
									<p class="sm-text m-0">
										Select host and licenses you want {{ contentData.bulkSet ? 'these contents' : 'this content' }} to play or
										toggle all.
									</p>
								</div>
								<div class="toggle-wrapper pt-1 pr-2">
									<mat-slide-toggle (change)="toggleAll.next($event)"></mat-slide-toggle>
								</div>
							</div>

							<div class="play-location-wrapper mt-3">
								<app-play-location
									*ngIf="!loadingWhitelistedLicenses; else loading"
									[host_licenses]="contentData.hostLicenses"
									[whitelisted_hosts]="whitelistedHosts"
									[whitelisted_licenses]="whitelistedLicenses"
									[toggle_all]="toggleAll.asObservable()"
									(to_blacklist)="licensesToBlacklist($event)"
									(toggle)="licenseIdToggled($event)"></app-play-location>
							</div>
						</div>
					</mat-tab>
				</mat-tab-group>
			</div>
			<!-- Play Where/Content Schedule -->
		</ng-container>
	</div>

	<!-- Save/Cancel Button -->
	<div class="save-cancel-button-wrapper">
		<button mat-button mat-raised-button class="theme-btn mr-2" [disabled]="updatingView" [mat-dialog-close]="playlistContent">
			<i class="fas fa-save mr-3 text-green"></i>
			<small class="font-weight-bold">Save</small>
		</button>
		<button mat-button mat-raised-button class="theme-btn bg-danger" [mat-dialog-close]>
			<i class="fas fa-times mr-3"></i>
			<small class="font-weight-bold">Cancel</small>
		</button>
	</div>
	<!-- Save/Cancel Button -->

	<ng-template #loading>
		<div class="content-settings-spinner-min-height d-flex justify-content-center w-100">
			<app-spinner></app-spinner>
		</div>
	</ng-template>
</div>
