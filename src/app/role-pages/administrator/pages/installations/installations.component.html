<div class="theme-container">
	<div class="title-section">
		<div class="d-flex align-items-center">
			<div class="flex-even">
				<h1 class="page-title">Installations</h1>
			</div>
			<div class="flex-even text-right">
				<form [formGroup]="form">
					<mat-form-field appearance="fill" monthDayFormat>
						<mat-label>Current / Selected Date</mat-label>
						<input formControlName="date" matInput [matDatepicker]="datePicker" readonly>
						<mat-datepicker-toggle matSuffix [for]="datePicker"></mat-datepicker-toggle>
						<mat-datepicker #datePicker startView="year" (monthSelected)="onSelectDate($event)"></mat-datepicker>
					</mat-form-field>
				</form>
			</div>
		</div>
		<hr>
	</div>

	<div class="content-section">
		<div class="row">
            <div class="col-3 col-lg">
                <mat-card class="h-100 dealer-card">
					<app-data-card-count *ngIf="installation_count; else small_loader"
                    [data_value]="installation_count.scheduled"
                    [data_label]="installation_count.scheduled_label"
                    [data_description]="installation_count.scheduled_description">
                    </app-data-card-count>
                </mat-card>
            </div>
			<div class="col-3 col-lg">
                <mat-card class="h-100 dealer-card">
					<app-data-card-count *ngIf="installation_count; else small_loader"
                    [data_value]="installation_count.prev"
                    [data_label]="installation_count.prev_label"
                    [data_description]="installation_count.prev_description">
                    </app-data-card-count>
                </mat-card>
            </div>
			<div class="col-3 col-lg">
                <mat-card class="h-100 dealer-card">
                    <app-data-card-count *ngIf="installation_count; else small_loader"
                    [data_value]="installation_count.current"
                    [data_label]="installation_count.current_label"
                    [data_description]="installation_count.current_description">
                    </app-data-card-count>
                </mat-card>
            </div>
            <div class="col-3 col-lg">
                <mat-card class="h-100 dealer-card">
                    <app-data-card-count *ngIf="installation_count; else small_loader"
                    [data_value]="installation_count.next"
                    [data_label]="installation_count.next_label"
                    [data_description]="installation_count.next_description">
                    </app-data-card-count>
                </mat-card>
            </div>
		</div>

		
	<hr class="my-4">
        <div *ngIf="!initial_load; else loader">
            <div>
				<div class="row" *ngIf="!initial_load">
					<div class="col-lg-12">
						<ng-container *ngIf="!searching; else loader">
							<mat-card *ngIf="filtered_data.length > 0; else no_data">
								<app-data-table 
								[table_data]="filtered_data"
								[table_columns]="installation_table_columns"
								[new_table]="true"
								[paging_details]="paging_data"
								(page_triggered)="getLicenses($event)"
								(to_sort_column)="getColumnsAndOrder($event)"
								[active_tab]="sort_column"
                                [sort_column]="sort_column"
                                [sort_order]="sort_order">
								</app-data-table>
							</mat-card>
						</ng-container>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<ng-template #loader>
	<div class="py-4">
		<mat-card>
			<app-spinner [diameter]="60"></app-spinner>
		</mat-card>
	</div>
</ng-template>

<ng-template #no_data>
	<mat-card class="p-5">
		<h3>Oh Boy.</h3>
		<p class="sm-text mb-3">
			There are no scheduled installations at the moment.
		</p>
	</mat-card>
</ng-template>

<ng-template #small_loader>
	<div class="py-4 white-bg">
		<app-spinner [diameter]="60"></app-spinner>
	</div>
</ng-template>